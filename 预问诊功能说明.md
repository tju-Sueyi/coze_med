# 智能预问诊功能使用说明

## 功能概述

智能预问诊功能旨在提高就诊效率,帮助患者在就诊前系统性地收集症状信息,生成结构化报告,供医生快速查看和参考。

## 主要特点

### 1. 患者端功能
- **智能问题生成**: AI根据患者主诉,自动生成8-12个针对性问诊问题
- **多种问题类型**: 支持文本输入、单选、多选、评分等多种问答形式
- **实时进度跟踪**: 显示问诊进度条,清晰了解完成情况
- **结构化报告**: 自动生成包含病情概述、关键信息、初步诊断、建议检查等内容的报告
- **自动保存**: 预问诊报告自动保存到患者健康档案中

### 2. 医生端功能
- **快速查看**: 医生可快速查看患者的预问诊报告列表
- **详细信息**: 查看完整的问诊记录和AI分析结果
- **紧急程度标识**: 通过颜色标识区分不同紧急程度
- **一键填入**: 将预问诊信息一键填入病历输入框,提高录入效率

## 使用流程

### 患者使用流程

1. **进入预问诊页面**
   - 登录系统后,在"医疗服务"中点击"智能预问诊"

2. **填写主诉**
   - 在步骤1中,详细描述主要不适症状
   - 可使用快速选择标签,如"头痛伴发热"、"胃痛伴恶心"等

3. **回答AI问题**
   - 系统会根据主诉生成8-12个问题
   - 逐一回答每个问题,支持文本、单选、多选等多种方式
   - 实时查看问诊进度

4. **查看报告**
   - 完成所有问题后,提交问诊
   - 系统生成预问诊报告,包含:
     * 紧急程度评估
     * 病情概述
     * 关键信息点
     * 初步诊断考虑
     * 建议检查项目
     * 建议就诊科室
     * 给医生的备注
   - 报告自动保存到健康档案

### 医生使用流程

1. **打开医生端病历页面**
   - 登录系统后,进入"医生端·结构化病历"页面

2. **加载患者预问诊**
   - 点击"加载预问诊"按钮
   - 查看患者的预问诊报告列表

3. **查看报告详情**
   - 点击任一报告可查看完整详情
   - 报告包含患者主诉、问诊记录、AI分析等

4. **快速录入病历**
   - 点击"填入病历"按钮
   - 系统自动将预问诊信息填入病历输入框
   - 医生可在此基础上补充和完善

## API接口说明

### 1. 开始预问诊
```
POST /api/pre-consultation/start
```
请求体:
```json
{
  "chief_complaint": "头痛伴发热三天",
  "patient_info": {
    "name": "张三",
    "age": 35,
    "gender": "male"
  }
}
```

### 2. 提交预问诊
```
POST /api/pre-consultation/submit
```
请求体:
```json
{
  "session_id": "uuid",
  "chief_complaint": "头痛伴发热三天",
  "answers": {
    "q1": {
      "question": "症状从什么时候开始的?",
      "answer": "三天前"
    },
    ...
  },
  "patient_info": {...}
}
```

### 3. 获取预问诊报告列表
```
GET /api/pre-consultation/reports
Headers: X-Username: 用户名
```

## 技术架构

### 后端 (backend_server.py)
- `/api/pre-consultation/start`: 生成问诊问题
- `/api/pre-consultation/submit`: 生成预问诊报告
- `/api/pre-consultation/reports`: 获取报告列表

### 前端
- `index.html`: 预问诊页面UI
- `pre_consultation.js`: 预问诊交互逻辑
- `script.js`: 与其他功能集成

### 数据存储
- 预问诊报告保存在 `data/records.json` 中
- 报告类型标识: `type: "pre_consultation"`

## 注意事项

1. **患者隐私**: 预问诊信息仅限患者本人和授权医生查看
2. **仅供参考**: AI生成的报告仅供医生参考,不能替代医生的专业诊断
3. **及时更新**: 建议患者在就诊前及时更新预问诊信息
4. **紧急情况**: 如遇紧急情况(标记为"危重"),建议立即就医

## 未来优化方向

1. **多语言支持**: 支持英文、日文等多种语言
2. **语音输入**: 支持语音录入症状描述
3. **图片上传**: 支持上传相关照片辅助诊断
4. **医患沟通**: 支持医生对预问诊进行补充提问
5. **智能提醒**: 根据紧急程度自动提醒患者尽快就医

## 联系支持

如有问题或建议,请联系技术支持团队。

